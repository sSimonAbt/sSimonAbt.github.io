/*!
 * OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/Core","sap/ui/core/Control","./library","sap/ui/core/ResizeHandler","./AlignedFlowLayoutRenderer","sap/ui/dom/units/Rem"],function(e,t,i,o,r,s){"use strict";var n=t.extend("sap.ui.layout.AlignedFlowLayout",{metadata:{library:"sap.ui.layout",properties:{minItemWidth:{type:"sap.ui.core.AbsoluteCSSSize",defaultValue:"12rem"},maxItemWidth:{type:"sap.ui.core.AbsoluteCSSSize",defaultValue:"24rem"}},defaultAggregation:"content",aggregations:{content:{type:"sap.ui.core.Control",multiple:true},endContent:{type:"sap.ui.core.Control",multiple:true}}}});n.prototype.init=function(){if(typeof ResizeObserver==="function"){this.oResizeObserver=new ResizeObserver(this.onResize.bind(this))}else{this._sResizeListenerId=o.register(this,this.onResizeHandler.bind(this))}};n.prototype.exit=function(){if(this._sResizeListenerId){o.deregister(this._sResizeListenerId);this._sResizeListenerId=""}if(this.oResizeObserver){this.oResizeObserver.disconnect();this.oResizeObserver=null}};n.prototype.onAfterRenderingOrThemeChanged=function(){var t=this.getDomRef(),i=this.getDomRef("endItem"),o=!!(this.getContent().length&&t&&i);if(o){var r=window.getComputedStyle(t,null),s=r.getPropertyValue("padding-top"),n=i.style;if(e.getConfiguration().getRTL()){n.left=r.getPropertyValue("padding-left")}else{n.right=r.getPropertyValue("padding-right")}n.bottom=s}this.reflow({domRef:t,endItemDomRef:i})};n.prototype.onBeforeRendering=function(){if(this.oResizeObserver){this.oResizeObserver.disconnect()}};n.prototype.onAfterRendering=function(){if(this.oResizeObserver){var e=this.getDomRef();if(e){this.oResizeObserver.observe(e)}}this.onAfterRenderingOrThemeChanged()};n.prototype.onThemeChanged=n.prototype.onAfterRenderingOrThemeChanged;n.prototype.onResizeHandler=function(e){if(e.size.width!==e.oldSize.width){this.reflow()}};n.prototype.onResize=function(e){window.requestAnimationFrame(this.reflow.bind(this))};n.prototype.reflow=function(t){var i=this.getContent();if(i.length===0||!i[0].isActive()){return}t=t||{};var o=t.domRef||this.getDomRef();if(!o||!o.offsetParent){return}var r=this.getRenderer().CSS_CLASS+"OneLine",s=true;var n=t.endItemDomRef||this.getDomRef("endItem"),f=this.getLastItemDomRef();if(n&&f){var a=o.lastElementChild,h=a.style;h.width="";h.height="";h.display="";o.classList.remove(r);var p=n.offsetHeight,l=n.offsetWidth,d=f.offsetTop,g=f.offsetLeft,u,m;if(e.getConfiguration().getRTL()){m=g}else{var R=Number.parseFloat(window.getComputedStyle(f).marginRight);var c=g+f.offsetWidth+R;m=o.offsetWidth-c}s=m>=l;if(s){if(this.checkItemsWrapping(o)){if(n.offsetTop<d){h.height=Math.max(0,p-d)+"px";if(f.offsetTop>=n.offsetTop){u=n.offsetLeft;g=f.offsetLeft;if(u>=g&&u<=g+f.offsetWidth){h.height=p+"px"}}h.display="block"}else{h.height="0";h.display=""}}else{if(n.offsetTop<d){h.height=p+"px"}h.display="block"}}else{h.height=p+"px";h.display="block"}var y=l+"px";h.width=y;h.minWidth=y}var v=true;if(this.checkItemsWrapping(o,v)){o.classList.remove(r)}else{o.classList.add(r)}};n.prototype.checkItemsWrapping=function(e,t){e=e||this.getDomRef();if(!e){return false}var i=e.firstElementChild,o=this.getLastItemDomRef();if(!i||!o){return false}var r=i.offsetTop,s=o.offsetTop,n=i.offsetHeight;if(s>=r+n){return true}if(t){return false}var f=this.getDomRef("endItem");return!!f&&f.offsetTop>=r+n};n.prototype.getLastItemDomRef=function(){var e=this.getContent(),t=e.length;if(t){var i=e[t-1],o=i.getDomRef();if(o){return o.parentElement}}return null};n.prototype.getLastVisibleDomRef=function(){return this.getDomRef("endItem")||this.getLastItemDomRef()};n.prototype.getNumberOfSpacers=function(){var e=this.getContent().length;if(e===0){return 0}var t=e,i=this.getMinItemWidth(),o;if(i.lastIndexOf("rem")!==-1){o=s.toPx(i)}else if(i.lastIndexOf("px")!==-1){o=parseFloat(i)}if(o){var r=Math.max(document.documentElement.clientWidth,window.screen.width);t=Math.abs(r/o)}t=Math.min(t,e-1);t=Math.max(1,t);t=Math.floor(t);return t};return n});